import{j as e,cR as Z,l as g,r as M,a5 as $,a6 as K,cS as I,c5 as L,cb as u,cT as ee,bz as se,cU as ie,cV as te,cW as ae,cX as ne,J as f,cY as re,cZ as oe,c_ as le,c$ as de,d0 as ce,d1 as me}from"./main-1.0.15.js";import{u as C,S as pe,a as ue,I as V,b as xe,c as ge,d as W,D as he,e as je,f as fe,g as be,h as ye,T as Se,M as ke,P as ve}from"./useMetadataColumns-1.0.15-a0d5d42d.js";import{a as A,B as c,u as z,c as R,d as Te,e as we,aq as Ae,ar as Ee,as as Ne,E as Pe,at as Me,au as De,av as Le,aw as Fe,ax as Ce,ay as Re,D as Oe}from"./main-1.0.15-e2ad00f6.js";import{i as Be}from"./index.esm-1.0.15-3dc3cbe3.js";import{S as k,a as N,C as Ue}from"./settings-1.0.15-3913c57c.js";import{u as E}from"./useTableUpdater-1.0.15-5d031e17.js";import{b as w,F as S,a as v,T as D,A as _e}from"./TextField-1.0.15-73384817.js";import{a as X}from"./ScopeEnum-1.0.15-32d3ffad.js";import{P as H}from"./PremiumFeature-1.0.15-58839b47.js";import{A as Q}from"./useScreenSize-1.0.15-a1dd46fa.js";import{b as Ge,c as Ve,a as We}from"./index.esm-1.0.15-8ab178c0.js";import{A as O,a as B}from"./AccordionSummary-1.0.15-ad1892ca.js";import{A as U,L as ze}from"./Link-1.0.15-0c287b6b.js";import{F as T}from"./FormControlLabel-1.0.15-2f48df6c.js";import{R as He}from"./RadioGroup-1.0.15-f84d6091.js";import{R as F}from"./Radio-1.0.15-7d52029a.js";import{A as b,a as y}from"./TableContainer-1.0.15-0a988586.js";import{C as qe}from"./Checkbox-1.0.15-19533231.js";import{I as P}from"./iconBase-1.0.15-5866dbfd.js";import"./useStoreTable-1.0.15-ce8ace5b.js";import"./useFormStore-1.0.15-33a2aa16.js";import"./Stepper-1.0.15-7dbc23a7.js";import"./Close-1.0.15-8d33e66c.js";import"./ActionsDml-1.0.15-409ee4a6.js";import"./MenuItem-1.0.15-cb0e11e9.js";import"./Menu-1.0.15-3ae4ddd1.js";import"./index-1.0.15-c2b31918.js";import"./DialogContent-1.0.15-e50a43f8.js";import"./Tabs-1.0.15-c2b715a3.js";import"./useSlot-1.0.15-4f7bfdbc.js";import"./index.esm-1.0.15-f3c7e2e0.js";import"./AlertTitle-1.0.15-cc3002eb.js";import"./InputAdornment-1.0.15-4ec316af.js";import"./ListItemIcon-1.0.15-b73952ad.js";import"./DateTimePicker-1.0.15-b600d307.js";import"./useMobilePicker-1.0.15-5df19a3e.js";import"./date-time-utils-1.0.15-31b6fdea.js";import"./dateViewRenderers-1.0.15-2bbfacab.js";import"./TimePicker-1.0.15-1545716b.js";import"./DatePicker-1.0.15-cd97ffeb.js";import"./index-1.0.15-3f6c5bf6.js";const Xe=({appId:i,columnIndex:r,tableColumn:s})=>{const a=A(),d=E(i);return e.jsxs(c,{sx:{margin:"0 1rem 2rem 1rem"},children:[e.jsx(w,{children:"Width"}),e.jsxs(c,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gridGap:"30px",alignItems:"center"},children:[e.jsx(X,{min:60,max:420,step:1,value:s.width,marks:[{value:60,label:"60"},{value:120,label:"120"},{value:180,label:"180"},{value:240,label:"240"},{value:300,label:"320"},{value:360,label:"360"},{value:420,label:"420"}],valueLabelDisplay:"auto",onChange:(t,l)=>{a(Z({appId:i,index:r,width:l})),d(!0),t.stopPropagation()}}),e.jsx("span",{children:"px"})]}),e.jsx(S,{children:e.jsxs(v,{children:["Column width is relative when responsiveness = ",e.jsx("strong",{children:"auto column hiding"}),"."]})})]})},Qe=({appId:i,columnIndex:r,tableColumn:s})=>{var j,o,h;g.debug(i,r,s),A();const a=M.useMemo(()=>$(K.getState(),i),[]);C(i,a);const[d,t]=M.useState(!1),l=z(p=>I(p,i));M.useState(!1),E(i);const m=!0;return e.jsxs(O,{disableGutters:!0,children:[e.jsxs(B,{expandIcon:e.jsx(R,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ge,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column actions"})]}),e.jsxs(U,{sx:{display:"grid",paddingTop:"1rem"},children:[e.jsxs(c,{sx:{margin:"0 10px",display:"grid",gridTemplateColumns:"auto"},children:[s.computedField?e.jsx(T,{control:e.jsx(k,{checked:!1,disabled:!0}),label:"Enable inline search",labelPlacement:"end"}):e.jsx(T,{control:e.jsx(k,{checked:s.inlineSearch&&!m,disabled:m,onChange:(p,_)=>{p.stopPropagation()}}),label:"Enable column filter",labelPlacement:"end"}),s.inlineSearch&&!m&&e.jsxs(c,{children:[e.jsxs(He,{sx:{flexDirection:"column",alignContent:"flex-start",marginLeft:"20px",marginTop:"10px",marginBottom:"10px"},children:[e.jsxs(w,{className:"align-label-radio",children:[e.jsx(F,{checked:s.inlineSearchEnum===L.SEARCHBOX,disabled:!0,onChange:p=>{p.stopPropagation()}}),"Searchbox"]}),e.jsxs(w,{className:"align-label-radio",children:[e.jsx(F,{checked:s.inlineSearchEnum===L.DROPDOWN,disabled:!0,onChange:p=>{p.stopPropagation()}}),"Drop-down list"]}),e.jsxs(w,{className:"align-label-radio",children:[e.jsx(F,{checked:s.inlineSearchEnum===L.MULTISELECT,disabled:!0,onChange:p=>{p.stopPropagation()}}),"Multi-select drop-down list"]}),e.jsxs(w,{className:"align-label-radio",children:[e.jsx(F,{checked:s.inlineSearchEnum===L.SEARCHPANE,disabled:!0,onChange:p=>{p.stopPropagation()}}),"Search pane"]})]}),s.lookup!==void 0&&((j=s.lookup)==null?void 0:j.loadOnStartup)!==!0&&e.jsx(S,{sx:{marginBottom:"20px",marginLeft:"5px"},children:e.jsxs(v,{sx:{color:(o=Q)==null?void 0:o.palette.error.main,"& svg":{marginRight:"5px",verticalAlign:"middle"}},children:[e.jsx(Te,{size:"18px"}),e.jsx("span",{children:"Drop-down lists are only supported for lookups loaded into memory on startup."})]})}),e.jsx(D,{fullWidth:!0,type:"number",label:"Order",value:s.columnFilterOrder,helperText:"Position of column filter in search panel.",disabled:!0,onChange:p=>{p.stopPropagation()},sx:{marginLeft:"15px",marginBottom:"20px"}})]}),((h=a==null?void 0:a.privs)==null?void 0:h.update)&&a.primary_key.length>0&&e.jsx(e.Fragment,{children:!s.computedField&&!s.columnName.startsWith("d.")?e.jsx(T,{control:e.jsx(k,{checked:l&&s.visible&&s.inlineEditing,disabled:!0,onChange:(p,_)=>{p.stopPropagation()}}),label:"Enable inline editing",labelPlacement:"end"}):e.jsx(T,{control:e.jsx(k,{checked:!1,disabled:!0}),label:"Enable inline editing",labelPlacement:"end"})})]}),!1,e.jsxs(v,{component:"div",sx:{marginTop:"30px"},children:[e.jsx(c,{children:e.jsxs(ze,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>t(!d),children:[e.jsx(we,{}),"What are column actions?"]})}),d&&e.jsxs(c,{sx:{marginTop:"20px",display:"grid",gap:"20px"},children:[e.jsx(c,{children:"Column actions are inline actions added to a table column to enhance usability and user-friendliness."}),e.jsx(c,{children:e.jsx("strong",{children:"Column filtering"})}),e.jsx(c,{children:"When column filtering is enabled, a search field is added to the table for performing column-specific searches. A search box allows wildcard searches, while drop-down lists perform exact searches. Exact searches can improve performance, especially when the searched columns are well-indexed."}),e.jsx(c,{children:"To enable the column filter feature, go to the TABLE section under Column Filters. You can also change the position of the column filters."}),e.jsx(c,{children:"The global filter performs a wildcard search. This feature can be disabled in the TABLE section under Global filter."}),e.jsx(c,{children:e.jsx("strong",{children:"Inline editing"})}),e.jsx(c,{children:"Inline editing allows users to change table columns directly, without needing to open a data entry form. This feature is not available for primary key fields. Drop-down lists are automatically generated for enum and set data types."})]})]}),e.jsx(H,{})]})]})},Ye=({appId:i,columnIndex:r,tableColumn:s})=>{var m,j;const a=A(),d=E(i),t=C(i),l=(o,h)=>{g.debug(o,h)};return e.jsxs(O,{disableGutters:!0,children:[e.jsxs(B,{expandIcon:e.jsx(R,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ve,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(U,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[(s.computedField||t[s.columnName]!==void 0&&(u(t[s.columnName].data_type)==="float"||u(t[s.columnName].data_type)==="number"||u(t[s.columnName].data_type)==="time"||u(t[s.columnName].data_type,!0)==="date"||u(t[s.columnName].data_type,!0)==="datetime"||u(t[s.columnName].data_type,!0)==="timestamp"||u(t[s.columnName].data_type,!0)==="time"))&&e.jsx(c,{children:e.jsxs(S,{children:[e.jsx(T,{control:e.jsx(k,{checked:!1,disabled:!0,onClick:o=>{o.stopPropagation()}}),label:"Localize",labelPlacement:"end"}),e.jsx(v,{children:s.computedField||t[s.columnName]!==void 0&&(u(t[s.columnName].data_type)==="float"||u(t[s.columnName].data_type)==="number")?"Localizes decimal and thousands seperators.":"Localizes date and time fields."})]})}),(t[s.columnName]!==void 0&&u(t[s.columnName].data_type,!0)==="float"||s.computedField!==void 0)&&e.jsxs(S,{children:[e.jsx(w,{children:"Decimals"}),e.jsx(X,{min:0,max:6,value:s.decimals,marks:[{value:0,label:"0"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"âˆž"}],valueLabelDisplay:"auto",disabled:!0,onChange:(o,h)=>{g.debug(h),o.stopPropagation()}}),e.jsx(v,{children:"Number of decimals displayed."})]}),t[s.columnName]!==void 0&&s.localize&&(u(t[s.columnName].data_type,!0)==="datetime"||u(t[s.columnName].data_type,!0)==="timestamp")&&e.jsx(c,{children:u(t[s.columnName].data_type)==="date"&&e.jsx(S,{children:e.jsx(T,{control:e.jsx(k,{checked:!1,disabled:!0,onClick:o=>{o.stopPropagation()}}),label:"Add trailing zeros to days and month",labelPlacement:"end"})})}),e.jsxs(S,{children:[e.jsxs(c,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(D,{type:"text",variant:"outlined",label:"Prefix",value:s.prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:o=>{o.stopPropagation()}}),e.jsx(D,{type:"text",variant:"outlined",label:"Suffix",value:s.suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:o=>{o.stopPropagation()}})]}),e.jsx(v,{children:"Adds a prefix and/or suffix to the column content (also added to inline text and number fields)."})]}),e.jsxs(S,{children:[e.jsx(D,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:s.classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:o=>{o.stopPropagation()}}),e.jsx(v,{children:"CSS classes (seperated by spaces) for custom styling."})]}),e.jsxs(S,{children:[e.jsx(T,{control:e.jsx(k,{checked:s.allowMarkup,onChange:(o,h)=>{a(ee({appId:i,index:r,allowMarkup:h})),d(!0),o.stopPropagation()}}),label:"Allow inline HTML",labelPlacement:"end"}),e.jsxs(v,{children:["Allows markup in column content.Â ",e.jsx("span",{style:{...s.allowMarkup&&{color:((j=(m=Q)==null?void 0:m.palette)==null?void 0:j.error.main)??"red"}},children:"Enabling this feature may pose a risk of cross-site scripting (XSS) attacks."})]})]}),e.jsxs(c,{sx:{display:"grid",gridTemplateColumns:"auto"},children:[e.jsx(T,{control:e.jsx(k,{checked:!1,disabled:!0,onClick:o=>{l(r,!s.visibleTablet),o.stopPropagation()}}),label:"Show column on tablet",labelPlacement:"end"}),e.jsx(T,{control:e.jsx(k,{checked:!1,disabled:!0,onClick:o=>{o.stopPropagation()}}),label:"Show column on mobile",labelPlacement:"end"})]}),e.jsx(H,{single:!1,margin:"0"})]})]})},Je=[{key:b.SUM,label:y.SUM},{key:b.MIN,label:y.MIN},{key:b.MAX,label:y.MAX},{key:b.AVG,label:y.AVG},{key:b.COUNT,label:y.COUNT},{key:b.UNIQUE,label:y.UNIQUE},{key:b.STD,label:y.STD},{key:b.VARIANCE,label:y.VARIANCE},{key:b.MEDIAN,label:y.MEDIAN}],q=[...Je],Ze=({appId:i,columnIndex:r,tableColumn:s})=>{g.debug(i,r,s),A(),E(i);const a=C(i),d=M.useMemo(()=>{var t;return(s==null?void 0:s.aggregation)===void 0?[]:(t=s==null?void 0:s.aggregation)==null?void 0:t.map(l=>q.filter(m=>m.key===l)[0])},[s==null?void 0:s.aggregation]);return!se(i)||s.computedField===void 0&&u(a[s.columnName].data_type)!=="number"?null:e.jsxs(O,{disableGutters:!0,children:[e.jsxs(B,{expandIcon:e.jsx(R,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(We,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Aggregations"})]}),e.jsxs(U,{sx:{marginTop:"10px"},children:[e.jsxs(S,{fullWidth:!0,children:[e.jsx(_e,{multiple:!0,options:q,disabled:!0,disableCloseOnSelect:!0,getOptionLabel:t=>t.label,value:d,onChange:(t,l)=>{t.stopPropagation()},renderOption:(t,l,{selected:m})=>e.jsxs("li",{...t,children:[e.jsx(qe,{icon:e.jsx(Ae,{}),checkedIcon:e.jsx(Ee,{}),style:{marginRight:8},checked:m}),l.label]}),renderInput:t=>e.jsx(D,{...t,label:"Select from list"})}),e.jsx(v,{children:"Allows multiple selections. Displayed in order of entry."})]}),e.jsx(H,{})]})]})},$e=({appId:i,columnIndex:r,tableColumn:s})=>{g.debug(i,r,s);const a=A(),d=E(i),l=C(i)[s.columnName],m=(j,o)=>{a(ie({appId:i,columnName:s.columnName})),a(te({appId:i,columnName:s.columnName})),a(ae({appId:i,index:j,lookup:o})),d(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(Xe,{appId:i,columnIndex:r,tableColumn:s}),e.jsx(Ye,{appId:i,columnIndex:r,tableColumn:s}),e.jsx(Qe,{appId:i,columnIndex:r,tableColumn:s}),e.jsx(pe,{appId:i,columnIndex:r,tableColumn:s,columnMetaData:l,setLookup:m}),e.jsx(Ze,{appId:i,columnIndex:r,tableColumn:s}),e.jsx(ue,{columnMetaData:l})]})},Ke=({appId:i,columnIndex:r})=>{g.debug(i,r);const s=A(),a=z(n=>ne(n,i,r));g.debug("tableColumn",a);const d=E(i),[t,l]=M.useState(!1),[m,j]=M.useState(void 0),o=n=>{n!==void 0&&(s(re({appId:i,index:n})),d(!0))},h=(n,x)=>{g.debug(n,x),s(oe({appId:i,index:n,visible:x})),d(!0)},p=(n,x)=>{g.debug(n,x),s(le({appId:i,index:n,queryable:x})),d(!0)},_=(n,x)=>{g.debug(n,x),s(de({appId:i,index:n,orderable:x})),d(!0)},G=(n,x)=>{s(ce({appId:i,index:n,alignment:x})),d(!0)},Y=(n,x,J)=>(g.debug(n,x,J),e.jsxs(e.Fragment,{children:[e.jsx(c,{sx:{"& svg":{pointerEvents:"none",opacity:"0.5"}},children:e.jsx(xe,{id:n,enabled:!1},n)}),e.jsxs(c,{sx:{display:"inline-grid",gridTemplateColumns:a.computedField!==void 0?"auto auto":"auto",justifyContent:"start",alignItems:"center",gap:"10px","& svg":{opacity:"0.5"}},children:[a.computedField!==void 0&&e.jsx(Be,{}),e.jsx(w,{children:x})]})]}));return e.jsxs(e.Fragment,{children:[e.jsxs(O,{disableGutters:!0,slotProps:{transition:{unmountOnExit:!0}},children:[e.jsxs(B,{className:"pp-column-settings",expandIcon:e.jsx(R,{}),sx:{justifyContent:"space-between"},children:[e.jsx(c,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center","& svg":{display:"flex"}},children:Y(a.columnName,a.columnLabel,r)}),e.jsxs("div",{style:{display:"inline-grid",gridTemplateColumns:"40px 40px 40px 40px"},children:[e.jsx(N,{title:"Visibility",position:"bottom",children:e.jsx(P,{onClick:n=>{h(r,!a.visible),n.stopPropagation()},children:e.jsx(V,{checked:a.visible,children:e.jsx(Ne,{})})})}),a.computedField?e.jsx(N,{title:"Edit",position:"bottom",children:e.jsx("span",{children:e.jsx(P,{disabled:!0,onClick:n=>{n.stopPropagation()},children:e.jsx(Me,{})})})}):e.jsx(N,{title:"Searchable",position:"bottom",children:e.jsx(P,{onClick:n=>{p(r,!a.queryable),n.stopPropagation()},children:e.jsx(V,{checked:a.queryable,alignRight:!1,children:e.jsx(Pe,{})})})}),a.computedField?e.jsx(N,{title:"Delete",position:"bottom",children:e.jsx(P,{onClick:n=>{j(r),l(!0),n.stopPropagation()},children:e.jsx(Le,{})})}):e.jsx(N,{title:"Sortable",position:"bottom",children:e.jsx(P,{onClick:n=>{_(r,!a.orderable),n.stopPropagation()},children:e.jsx(V,{checked:a.orderable,children:e.jsx(De,{})})})}),e.jsx(N,{title:"Alignment",position:"bottom",children:e.jsxs(P,{onClick:n=>{a.alignment===f.LEFT?G(r,f.CENTER):a.alignment===f.CENTER?G(r,f.RIGHT):a.alignment===f.RIGHT&&G(r,f.LEFT),d(!0),n.stopPropagation()},children:[a.alignment===f.LEFT&&e.jsx(Fe,{}),a.alignment===f.CENTER&&e.jsx(Ce,{}),a.alignment===f.RIGHT&&e.jsx(Re,{})]})})]})]}),e.jsx(U,{children:e.jsx($e,{appId:i,columnIndex:r,tableColumn:a})})]},r),e.jsx(Ue,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:t,setOpen:l,onConfirm:()=>o(m)})]})},Gs=({appId:i,metaData:r})=>{g.debug(i,r),A();const s=ge(W(ve),W(ke),W(Se));E(i);const a=t=>{const{active:l,over:m}=t;g.debug(l,m),l==null||l.id,m==null||m.id},d=z(t=>me(t,i));return d===void 0||d.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx(he,{autoScroll:!0,sensors:s,collisionDetection:je,onDragEnd:a,children:e.jsx(fe,{items:d,children:d.map((t,l)=>e.jsx(be,{id:t,children:e.jsx(Ke,{appId:i,columnIndex:l})},t))})}),e.jsx(ye,{appId:i,target:Oe.TABLE})]})};export{Gs as default};
